<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title>Mediawiki Report -- <%= @wiki.to_s %></title>
    <style type="text/css">
      table.stats { 
        border-collapse: separate;
        border:none;
        border-top:2px solid black;
        border-bottom:2px solid black;
      }
      table.stats caption {
        font-size:large;
        font-family:sans;
      }
      table.stats tbody th { 
        text-align:left; 
      }
      table.stats tbody td { 
        text-align:right; 
      }
      table.stats thead tr th { 
        border-bottom:2px solid black;
      }
      table.stats thead th { 
        padding-left:2em;
        text-align:right;
      }

    </style>
  </head>

  <body>
    <%# some convenience definitions %>
    <% wiki = @wiki %>
    <% full = wiki.filter.clone; full.include_all_namespaces %>
    <% wiki.filter.namespace=0 %>
    <% users = @wiki.users %>
    <% pages = @wiki.pages %>
    <% revisions = @wiki.revisions %>
    
    <h1>Mediawiki Report -- <%= @wiki.to_s %></h1>

    <h2>Some general data</h2>

    We have <%=@wiki.pages(full).length%> pages with 
    <%=@wiki.revisions(full).length%> revisions from 
    <%=users.length%> users (<%=pages.length%> pages with
    <%=revisions.length%> revisions in Namespace 0).

    <table class="stats">
      <caption>Global Wiki Statistics</caption>
      <thead>
	<tr><th></th>
	  <th>avg</th><th>stddev</th><th>med</th><th>min</th><th>max</th></tr>
      </thead>
      <tbody>
	<% wiki.global_userstats.each do |a| %>
	<tr>
	  <th><%= a.shift %></th>
          <% a.each do |d| %><td><%="%.2f" % d%></td><%end%>
        </tr>
        <% end %>
      </tbody>
    </table>

    <h2>And a nice distribution</h2>

    <% ur = users.collect { |u| u.revisions.length }
       ur.gp_plot_lorenz(:svg=>'lorenz.svg') 
       ur.gp_plot_lorenz(:png=>'lorenz.png', :size => '500,500') 
    %>
    <p>
      <a href="lorenz.svg">
	<img alt="lorenz-curve revisions per user" src="lorenz.png" />
      </a>
    </p>

    <hr>
    <address>
      Generated by mediawikiparser &lt;<a href="mailto&#x003a;%6Blaus.stein
&#x0040;
uni-bamberg.de">klaus.stein<!--nein-->&#x0040;<!--nein-->uni-bamberg.de</a>&gt;
    </address>
<!-- Created: Thu Jul 10 14:37:18 CEST 2008 -->
<!-- hhmts start -->
<!-- hhmts end -->
  </body>
</html>
